<!DOCTYPE html>
<html ng-app="KendoDemos">
<head>
    <title>AngularJS</title>
    <meta charset="utf-8">
    <!--
    <link href="../content/shared/styles/examples-offline.css" rel="stylesheet">
    <link href="../../styles/kendo.rtl.min.css" rel="stylesheet">
    <link rel="stylesheet" href="//kendo.cdn.telerik.com/2016.3.914/styles/kendo.common.min.css" />
    <!--<link rel="stylesheet" href="//kendo.cdn.telerik.com/2016.3.914/styles/kendo.metro.min.css" />
    <link rel="stylesheet" href="//kendo.cdn.telerik.com/2016.3.914/styles/kendo.metro.mobile.min.css" />
-->
    <link href="../content/shared/styles/examples-offline.css" rel="stylesheet">

    <link rel="stylesheet" href="//kendo.cdn.telerik.com/2016.3.914/styles/kendo.common.min.css" />
    <link rel="stylesheet" href="//kendo.cdn.telerik.com/2016.3.914/styles/kendo.nova.min.css" />
    <link rel="stylesheet" href="//kendo.cdn.telerik.com/2016.3.914/styles/kendo.nova.mobile.min.css" />
    <!--
    <link rel="stylesheet" href="http://kendo.cdn.telerik.com/2016.3.914/styles/kendo.common.min.css"/>
     <link rel="stylesheet" href="http://kendo.cdn.telerik.com/2016.3.914/styles/kendo.rtl.min.css"/>
    <link rel="stylesheet" href="http://kendo.cdn.telerik.com/2016.3.914/styles/kendo.metro.min.css"/>
    <link rel="stylesheet" href="http://kendo.cdn.telerik.com/2016.3.914/styles/kendo.metro.mobile.all.min.css"/>
-->

    <script src="../../js/jquery.min.js"></script>
    <script src="../../js/jszip.min.js"></script>
    <script src="../../js/angular.min.js"></script>
    <script src="../../js/kendo.all.min.js"></script>
    <script src="../content/shared/js/console.js"></script>
    <script src="./jquery-watch.js"></script>
    <script>

    </script>


</head>
<body ng-view resize>
    <div ng-controller="MyCtrl">

        <a class="offline-button" href="../index.html">Export Brochure to Excel</a>
        <div kendo-window="wBrochureMain" k-title="'Brochure Forecast: UK 2017/01 '"
            k-width="1400" k-height="385" k-visible="true"
            k-content="{ url: '../spreadsheet/index.html' }">
        </div>
        <div kendo-window="wBrochureHistory" k-title="'Brochure History'"
             k-width="400" k-height="300" k-visible="false"
             k-content="{ url: '../content/web/loremIpsum.html' }">
        </div>
        <div kendo-window="wBrochureStages" k-title="'Brochure Stages'"
             k-width="600" k-height="200" k-visible="false"
             k-content="{ url: '../content/web/loremIpsum.html' }">
        </div>
        <div kendo-window="wBrochureImages" k-title="'Brochure Images'"
             k-width="400" k-height="300" k-visible="true"
             k-content="{ url: './images.html' }">
        </div>
        <div kendo-window="wBrochureProducts" k-title="'Product Images'"
             k-width="200" k-height="300" k-visible="true"
             k-content="{ url: './product.html' }">
        </div>
        <div kendo-window="wBrochureChart" k-title="'Brochure Chart'"
             k-width="400" k-height="300" k-visible="true"
             k-content="{ url: './chart.html' }">
        </div>
        <div kendo-window="wBrochureNotes" k-title="'Notes'"
             k-width="600" k-height="200" k-visible="false"
             k-content="{ url: '../content/web/loremIpsum.html' }">
        </div>
    </div>

<script>



  var myAppModule =  angular.module("KendoDemos", [ "kendo.directives" ])
      .controller("MyCtrl", function($scope,$http){

          $scope.onSeriesHover = function(e) {
                kendoConsole.log(kendo.format("event :: seriesHover ({0} : {1})", e.series.name, e.value));
            };

          $scope.electricity = new kendo.data.DataSource({
                transport: {
                    read: {
                        url: "../content/dataviz/js/spain-electricity.json",
                        dataType: "json"
                    }
                },
                sort: {
                    field: "year",
                    dir: "asc"
                }
            });

          $scope.firstRun = true;
          $scope.onchange = function (arg) {
            debugger;

            if (!$scope.firstRun) {

                try {


                kendoConsole.log(arg.range._ref.topLeft.row);
                kendoConsole.log(arg.range._ref.topLeft.col);
                var myrow = 1+arg.range._ref.topLeft.row;
                var mycol = 1+arg.range._ref.topLeft.col;

                kendoConsole.log(myrow);
                kendoConsole.log(mycol);

                $scope.sheet.range("A"+myrow).background("#f4eb42");
                $scope.sheet.range("A"+myrow).value("C");

                }
                catch(err) {
                    kendoConsole.log(err);
                }

            } else {

            }
          }

          kendo.spreadsheet.registerEditor("salesclass", function(){
                var context, dlg, model;

                // Further delay the initialization of the UI until the `edit` method is
                // actually called, so here just return the object with the required API.

                return {
                    edit: function(options) {
                        context = options;
                        open();
                    },
                    icon: "k-i-custom k-i-background"
                };

                // This function actually creates the UI if not already there, and
                // caches the dialog and the model.
                function create() {
                    if (!dlg) {
                        model = kendo.observable({
                            value: "#000000",
                            ok: function() {
                                // This is the result when OK is clicked. Invoke the
                                // callback with the value.
                                context.callback(model.value);
                                dlg.close();
                            },
                            cancel: function() {
                                dlg.close();
                            }
                        });


                        <!--  "  <div data-role='flatcolorpicker' data-bind='value: value'></div>" + -->

                        var el = $("<div data-visible='true' data-role='window' data-modal='true' data-resizable='false' data-title='Select Foresight Sales Class:'>" +
                                   "    <h4>Select Sales Class:</h4>" +
                                   "    <input kendo-auto-complete ng-model='value' k-data-source='salesClasses' style='width: 100%;' />" +
                                   "    <p class='demo-hint'>Your selection: {{ value }}</p>"+
                                   "    <button style='width: 5em' class='k-button' data-bind='click: ok'>OK</button>" +
                                   "    <button style='width: 5em' class='k-button' data-bind='click: cancel'>Cancel</button>" +
                                   "</div>");
                        kendo.bind(el, model);

                        // Cache the dialog.
                        dlg = el.getKendoWindow();
                    }
                }

                function open() {
                    create();
                    dlg.open();
                    dlg.center();

                    // If the selected cell already contains some value, reflect
                    // it in the custom editor.
                    var value = context.range.value();
                    if (value != null) {
                        model.set("value", value);
                    }
                }
          });

          $scope.selectionPrevRow=-1;
          $scope.selectionPrevCol=-1;

          $scope.wBrochureImagesVisible=false;

          $scope.spreadSheetPanelOpen = false;
          $scope.keyPress =function(e) {


                 $scope.firstRun = false;

                 debugger;

                 console.log($scope.wBrochureImages);

                 $scope.wBrochureChart.wrapper[0].style.zIndex=$scope.windowsZIndex[3][1];
                 $scope.wBrochureImages.wrapper[0].style.zIndex=$scope.windowsZIndex[1][1];
                 $scope.wBrochureProducts.wrapper[0].style.zIndex=$scope.windowsZIndex[2][1];
                 $scope.wBrochureMain.wrapper[0].style.zIndex=$scope.windowsZIndex[0][1];


                 debugger;

                 if (!$scope.wBrochureImagesVisible) {
                    $scope.wBrochureImages.setOptions({position: { top: "420px",left: "1px" }});
                    $scope.wBrochureImages.restore();
                    $scope.wBrochureProducts.setOptions({position: { top: "420px",left: "405px" }});
                    $scope.wBrochureProducts.restore();
                    $scope.wBrochureChart.setOptions({position: { top: "420px",left: "605px" }});
                    $scope.wBrochureChart.restore();
                    $scope.wBrochureImagesVisible=true;
                    debugger;
                 }

                 debugger;

                 $scope.wBrochureChart.wrapper[0].style.zIndex=$scope.windowsZIndex[3][1];
                 $scope.wBrochureImages.wrapper[0].style.zIndex=$scope.windowsZIndex[1][1];
                 $scope.wBrochureProducts.wrapper[0].style.zIndex=$scope.windowsZIndex[2][1];
                 $scope.wBrochureMain.wrapper[0].style.zIndex=$scope.windowsZIndex[0][1];

                 debugger;

                 $scope.selectionPrevRow=$scope.selectionRow;
                 $scope.selectionPrevCol=$scope.selectionCol;

                 console.log('Old values:'+$scope.selectionPrevRow+'-'+$scope.selectionCol);

                 $scope.activeCell = $scope.sheet.activeCell();
                 $scope.selectionRow=$scope.activeCell.topLeft.row;
                 $scope.selectionCol=$scope.activeCell.topLeft.col;
                 if ($scope.selectionRow>28) {
                    $scope.spreadNumber = 2;
                 } else {
                    $scope.spreadNumber = Math.floor(($scope.selectionRow+1)/2)*2;
                 }

                 $scope.productNumber = Math.round(Math.random()*3);
                 if ($scope.productNumber==0) $scope.productNumber=1;

                 debugger;
                 console.log('New values:'+$scope.selectionRow+'-'+$scope.selectionCol);


                 debugger;

                 if ($scope.selectionPrevRow!=$scope.selectionRow || $scope.selectionPrevCol!=$scope.selectionCol) {


                     if ($scope.selectionCol==13) {
                        /*
                        if ($scope.sheet2!=null) {
                            debugger;
                            $scope.sheet2.range("A1:A1000").clear();
                        }
                        */

                        $scope.lookup_splitter.expand(".k-pane:last");
                        $scope.spreadSheetPanelOpen = true;

                        $scope.sheet2.range("A1").background("#ff4251");
                        $scope.sheet2.range("A1").color("white");
                        $scope.sheet2.range("A1").bold(true);
                        $scope.sheet2.columnWidth(0, 300);
                        $scope.sheet2.range("A1").value('Values');
                        /*
                        $scope.sheet2.range("A2").value('REGULAR PRICE');
                        $scope.sheet2.range("A3").value('STRAIGHT DISCOUNTING');
                        $scope.sheet2.range("A4").value('GWP/PWP/ORDER BUILDERS');
                        $scope.sheet2.range("A5").value('STRAIGHT DISCOUNTING');
                        $scope.sheet2.range("A6").value('COMBINATION OFFERS');
                        */
                        $scope.sheet2.frozenRows(1);
                        $scope.sheet2.frozenColumns(1);


                        debugger;

                        console.log("--->"+$scope.activeCell.topLeft);

                        debugger;
                        console.log("--->"+$scope.sheet.range($scope.activeCell.topLeft).values());

                        for (var e=2;e<7;e++) {
                            $scope.sheet2.range("A"+e).background("white");
                            $scope.sheet2.range("A"+e).color("black");
                            $scope.sheet2.range("A"+e).bold(false);
                        }

                        for (var e=2;e<7;e++) {
                            var x = $scope.sheet.range($scope.activeCell.topLeft).values()[0][0];
                            var y = $scope.sheet2.range("A"+e).values()[0][0];
                            console.log("-------->"+x+"-"+y);
                            debugger;
                            if (x==y) {
                                debugger;
                                //$scope.sheet2.range("A"+e).select();
                                console.log("A"+e+"--->*"+$scope.sheet2.activeCell().topLeft);
                                //$scope.sheet.range($scope.activeCell.topLeft).select();
                                $scope.sheet2.range("A"+e).background("#3e9ed6");
                                $scope.sheet2.range("A"+e).color("white");
                                $scope.sheet2.range("A"+e).bold(true);

                                if (e>3) {
                                    $scope.sheet2.range("A3").background("#92d3e4");
                                    $scope.sheet2.range("A3").color("white");
                                    $scope.sheet2.range("A3").bold(true);
                                } else {
                                    $scope.sheet2.range("A4").background("#92d3e4");
                                    $scope.sheet2.range("A4").color("white");
                                    $scope.sheet2.range("A4").bold(true);
                                }


                                //$scope.sheet.recalc();
                                debugger;
                                $scope.lookup_splitter.collapse(".k-pane:last");
                                $scope.lookup_splitter.expand(".k-pane:last");
                                break;
                            }
                        }




                     } else {
                     /*
                        debugger;
                        if ($scope.spreadSheetPanelOpen) {
                            debugger;
                            $scope.spreadSheetPanelOpen=false;
                            //$scope.sheet.range($scope.activeCell.topLeft).select();

                        }
                     */
                        $scope.lookup_splitter.collapse(".k-pane:last");





                     }

  	             }

  	             if ($scope.selectionCol==12) {
  	                var xxx = $("#subsheet").find(".k-spreadsheet").data("kendoSpreadsheet");
  	             }


            }

          $scope.keyPress2 =function(e) {


                 $scope.activeCell = $scope.sheet.activeCell();
                 $scope.selectionRow=$scope.activeCell.topLeft.row;
                 $scope.selectionCol=$scope.activeCell.topLeft.col;

                 var valueCell = $scope.sheet2.activeCell();
                 var valueRow = valueCell.topLeft.row;
                 var valueCol = valueCell.topLeft.col;

  	             $scope.sheet.range($scope.activeCell.topLeft).value($scope.sheet2.range(valueCell.topLeft).values()[0][0]);

                 var myrow = 1+ $scope.activeCell.topLeft.row;
                 console.log(myrow);

                 $scope.sheet = $scope.spreadsheet.activeSheet();

                 debugger;

                 $scope.sheet.range("A"+myrow).background("#f4eb42");

                 var kk = $scope.sheet.range("A"+myrow);

                 debugger;
                 console.log(kk);

                 $scope.sheet.range("A"+myrow).value("C");



                 debugger;
          }

          $scope.hello = "Hello from Controller!";

          $scope.sheets= [{ name: "Core Brochure" }];
          $scope.sheets2= [{ name: "Values" }];

          $scope.value1DataRecords = new kendo.data.ObservableArray([]);

          $scope.value1DataSource = new kendo.data.DataSource({
	        data: $scope.value1DataRecords,
			batch: true,
            schema: {
                model: {
                fields: {
                    ID: {type: 'number'},
                    VALUE: {type: 'string'}
                }
            }
          }});

          $scope.excelDataRecords = new kendo.data.ObservableArray([]);

          $scope.excelDataSource = new kendo.data.DataSource({
	        data: $scope.excelDataRecords,
			batch: true,
            schema: {
                model: {
                fields: {
                    SELECTED: {type: 'string'},
                    PAGE_NUMBER: {type: 'number'},
                    PRFL_CD: {type: 'number'},
                    PRFL_NM: {type: 'string'},
                    OFFR_DESC_TXT: {type: 'string'},
                    CATGRY_NM: {type: 'string'},
                    BRND_NM: {type: 'string'},
                    FORM_GRP_DESC_TXT: {type: 'string'},
                    FORM_DESC_TXT: {type: 'string'},
                    SGMT_NM: {type: 'string'},
                    GENDR_DESC_TXT: {type: 'string'},
                    PRICING_GROUP: {type: 'string'},
                    SLS_CLS_DESC_TXT: {type: 'string'},
                    PROMTN_DESC_TXT: {type: 'string'},
                    SLS_PRC_AMT: {type: 'number'},
                    PG_WGHT_PCT: {type: 'number'},
                    PG_TYP_DESC_TXT: {type: 'string'},
                    MICR_NCPSLTN_IND: {type: 'string'},
                    SKU_COUNT: {type: 'number'},
                    REG_PRC_AMT: {type: 'number'}
                }
            }
          }});

          $scope.$on("kendoRendered", function (event) {

            debugger;



            console.log($scope.lookup_splitter);

            $scope.lookup_splitter.collapse(".k-pane:last");

            console.log($scope.wBrochureMain);
            $scope.wBrochureMain.setOptions({ actions: ["Pin","Custom", "Minimize", "Maximize"] });
            $scope.wBrochureMain.setOptions({position: { top: "1px" , left: "1px" }});
            $scope.wBrochureMain.wrapper.find(".k-i-custom").click(function (e) {
                debugger;

                console.log($scope.spreadsheet);

                debugger;

                $scope.spreadsheet.saveAsExcel();

                debugger;

                e.preventDefault();
            });
            $scope.wBrochureMain.maximize();
            console.log($scope.wBrochureImages);

            $scope.wBrochureProducts.setOptions({ actions: ["Minimize", "Maximize"] });
            $scope.wBrochureProducts.setOptions({position: { top: "710px",left: "405px" }});
            $scope.wBrochureProducts.minimize();

            $scope.wBrochureChart.setOptions({ actions: ["Minimize", "Maximize"] });
            $scope.wBrochureChart.setOptions({position: { top: "710px",left: "605px" }});
            $scope.wBrochureChart.minimize();

            $scope.wBrochureImages.setOptions({ actions: ["Pin","Expand","Collapse","Custom", "Minimize", "Maximize"] });
            $scope.wBrochureImages.setOptions({position: { top: "710px",left: "1px" }});
            $scope.wBrochureImages.wrapper.find(".k-i-custom").click(function (e) {
                debugger;
                $scope.zIndexwBrochureImages = $scope.wBrochureImages.wrapper[0].style.zIndex;
                alert($scope.wBrochureImages.wrapper[0].style.zIndex);
                e.preventDefault();
            });
            $scope.wBrochureImages.wrapper.find(".k-i-expand").click(function (e) {
                e.preventDefault();
            });
            $scope.wBrochureImages.wrapper.find(".k-i-collapse").click(function (e) {
                e.preventDefault();
            });
            $scope.wBrochureImages.minimize();

            $scope.windowsZIndex = [ ['wBrochureMain',10005],['wBrochureImages',10050],['wBrochureProducts',10055],['wBrochureChart',10060 ]];

            ////////////////////////

            console.log($scope.wBrochureHistory);
            $scope.wBrochureHistory.setOptions({ actions: ["Pin","Custom", "Minimize", "Maximize"] });
            $scope.wBrochureHistory.setOptions({position: { top: "35px",left: "5px" }});
            $scope.wBrochureHistory.wrapper.find(".k-i-custom").click(function (e) {
                alert("wBrochureHistory - Custom action button clicked");
                e.preventDefault();
            });
            $scope.wBrochureHistory.minimize();


            console.log($scope.wBrochureStages);
            $scope.wBrochureStages.setOptions({ actions: ["Pin","Custom", "Minimize", "Maximize"] });
            $scope.wBrochureStages.setOptions({position: { top: "55px" ,left: "5px" }});
            $scope.wBrochureStages.wrapper.find(".k-i-custom").click(function (e) {
                alert("wBrochureStages - Custom action button clicked");
                e.preventDefault();
            });
            $scope.wBrochureStages.minimize();






            console.log($scope.wBrochureNotes);
            $scope.wBrochureNotes.setOptions({ actions: ["Pin","Custom", "Minimize", "Maximize"] });
            $scope.wBrochureNotes.setOptions({position: { top: "115px",left: "5px" }});
            $scope.wBrochureNotes.wrapper.find(".k-i-custom").click(function (e) {
                alert("wBrochureNotes - Custom action button clicked");
                e.preventDefault();
            });
            $scope.wBrochureNotes.minimize();

            $scope.spreadsheet.bind("change", function(e) {
                console.log("Spreadsheet change, new value: " + e.range.value());

            });

            console.log($scope.spreadsheet);

            $scope.wBrochureMain.bind("maximize", function(e) {

                /*
                console.log(e);
                debugger;
                console.log(e.sender.wrapper[0]);
                console.log(e.sender.wrapper[0].style);
                console.log(e.sender.wrapper[0].style.height);
                debugger;
                $('.k-spreadsheet').css('height', e.sender.wrapper[0].style.height);//55
                $('.k-spreadsheet').css('width',  e.sender.wrapper[0].style.width);//20
                */

            });

            $scope.wBrochureMain.bind("resize", function(e) {

                /*
                debugger;
                console.log(e);
                $('.k-spreadsheet').css('height', e.height+55);
                $('.k-spreadsheet').css('width', e.width-20);
                */

            });


            $http.get('../grid/values1.json').then(function success(response) {

                var cs = '';
			    var d = response.data;
				var xxx = JSON.stringify(d);
				xxx = xxx.substring(1, xxx.length-1);
				var codeS = '$scope.value1DataRecords.unshift('+xxx+');';
				eval(codeS);

                $scope.lookup_spreadsheet.activeSheet().setDataSource($scope.value1DataSource, [
                                {field: "VALUE", title: "Value"}
                        ]);

                $scope.zzz = 6
                $scope.sheet2 = $scope.lookup_spreadsheet.activeSheet();

                $scope.myFilter2 = new kendo.spreadsheet.TopFilter({ type: "topNumber", value: $scope.zzz });
                $scope.sheet2.range("A1:A6").filter([ { column: 0, filter: $scope.myFilter2 } ]);


            }, function error(response) {
                debugger;
                alert('something went wrong')
                console.log(response);
            });

            $http.get('../grid/actual_campaigns_data.json')
            .then(function success(response) {


						var cs = '';
					    var d = response.data;
						var xxx = JSON.stringify(d);
						xxx = xxx.substring(1, xxx.length-1);
						var codeS = '$scope.excelDataRecords.unshift('+xxx+');';
						eval(codeS);

						//alert($scope.excelDataRecords.length);

						debugger;

						$scope.spreadsheet.activeSheet().setDataSource($scope.excelDataSource, [
                                {field: "SELECTED", title: " "},
                                {field: "PAGE_NUMBER", title: "Spread"},
                                {field: "PRFL_CD", title: "Profile Code"},
                                {field: "PRFL_NM", title: "Profile Name"},
                                {field: "OFFR_DESC_TXT", title: "Offer Description"},
                                {field: "CATGRY_NM", title: "Category"},
                                {field: "BRND_NM", title: "Brand"},
                                {field: "FORM_GRP_DESC_TXT", title: "Form Group"},
                                {field: "FORM_DESC_TXT", title: "Form"},
                                {field: "SGMT_NM", title: "Segment"},
                                {field: "GENDR_DESC_TXT", title: "Gender"},
                                {field: "PRICING_GROUP", title: "Pricing Group"},
                                {field: "SLS_CLS_DESC_TXT", title: "Sales Class"},
                                {field: "PROMTN_DESC_TXT", title: "Promotion"},
                                {field: "SLS_PRC_AMT", title: "Avg Selling Price"},
                                {field: "PG_WGHT_PCT", title: "Page Weight %"},
                                {field: "PG_TYP_DESC_TXT", title: "Page Type"},
                                {field: "MICR_NCPSLTN_IND", title: "Micro"},
                                {field: "SKU_COUNT", title: "Sku Count"},
                                {field: "REG_PRC_AMT", title: "Regular Price"}
                        ]);
                        debugger;

                        $scope.sheet = $scope.spreadsheet.activeSheet();


                        $scope.sheet.frozenRows(1);
                        $scope.sheet.frozenColumns(5);

                        $scope.sheet.range("A1:T1").background("#ff4251");
                        $scope.sheet.range("A1:T1").color("white");
                        $scope.sheet.range("A1:T1").bold(true);

                        $scope.sheet.range("B2:B"+($scope.excelDataRecords.length+1)).background("#3e9ed6");
                        $scope.sheet.range("B2:B"+($scope.excelDataRecords.length+1)).color("white");


                        $scope.myFilter = new kendo.spreadsheet.TopFilter({ type: "topNumber", value: $scope.excelDataRecords.length+1 });

                        $scope.sheet.range("A1:S"+($scope.excelDataRecords.length+1)).filter([ { column: 0, filter: $scope.myFilter } ]);

                        debugger;

                        //$scope.sheet.range("M2:M2000").editor("salesclass");

                        var x = $scope.sheet.range("B1");

                        debugger;

                        console.log(x);

                        $scope.sheet.columnWidth(0, 20);
                        $scope.sheet.columnWidth(1, 80);
                        $scope.sheet.columnWidth(2, 100);
                        $scope.sheet.columnWidth(3, 250);
                        $scope.sheet.columnWidth(4, 250);
                        $scope.sheet.columnWidth(5, 200);
                        $scope.sheet.columnWidth(6, 200);
                        $scope.sheet.columnWidth(7, 200);
                        $scope.sheet.columnWidth(8, 200);
                        $scope.sheet.columnWidth(9, 200);
                        $scope.sheet.columnWidth(10, 100);
                        $scope.sheet.columnWidth(11, 200);
                        $scope.sheet.columnWidth(12, 200);
                        $scope.sheet.columnWidth(13, 200);


                        $scope.sheet.range("M2:M2500").validation({
                              dataType: "list",
                              showButton: true,
                              comparerType: "list",
                              from: '{ "NEW COI","IN-LINE (EXCL NR)","EXCESS","NEW REPEAT" }',
                              allowNulls: false,
                              type: "reject",
                              titleTemplate: "Invalid Sales Class",
                              messageTemplate: "Valid values are: \n NEW COI,\nIN-LINE (EXCL NR),\nEXCESS,\nNEW REPEAT"
                        });

                        $scope.sheet.range("P2:P2500").validation({
                              dataType: "number",
                              showButton: true,
                              comparerType: "between",
                              from: '0',
                              to: '1500',
                              type: 'warning',
                              allowNulls: false,
                              titleTemplate: "Invalid Page Weight",
                              messageTemplate: "Valid values are: 0% - 1500%"
                        });

                        $scope.sheet.columnWidth(14, 150);
                        $scope.sheet.columnWidth(15, 150);
                        $scope.sheet.columnWidth(16, 150);
                        $scope.sheet.columnWidth(17, 150);
                        $scope.sheet.columnWidth(18, 150);
                        $scope.sheet.columnWidth(19, 150);

                        $scope.sheet.range("E1:E"+($scope.excelDataRecords.length+1)).borderRight({ size: 5, color: "#3e9ed6" });

                        //$scope.sheet.range("C1:I"+($scope.excelDataRecords.length+1)).wrap(true);

                        $scope.sheet.range("L1:R1").background("#e83c75");
                        $scope.sheet.range("L1:R"+($scope.excelDataRecords.length+1)).borderRight({ size: 2, color: "#e83c75" });
                        $scope.sheet.range("L1:R"+($scope.excelDataRecords.length+1)).borderLeft({ size: 2, color: "#e83c75" });

                        //$scope.sheet.range("A2:J1250").enable(false);
                        //$scope.sheet.range("R2:S1250").enable(false);

                        console.log($scope.spreadsheet.activeSheet());
                        debugger;



                        var el = $(".k-window");

                        // hook up the watcher
                        el.watch({
                            // specify CSS styles or attribute names to monitor
                            properties: "zIndex",

                            // callback function when a change is detected
                            callback: function(data, i) {


                                var propChanged = data.props[i];
                                var newValue = data.vals[i];

                                var el = this;
                                var el$ = $(this);

                                console.log('el->'+el);
                                console.log('el->'+el.innerHTML);


                                for (var hh=0; hh<$scope.windowsZIndex.length; hh++ ){
                                    if (el.innerHTML.indexOf($scope.windowsZIndex[hh][0])>-1) {
                                        el.style.zIndex = $scope.windowsZIndex[hh][1];
                                    }
                                }

                                console.log(el.style.zIndex);

                                // do what you need based on changes
                                // or do your own checks
                            }
                        });



			}, function error(response) {
                debugger;
                alert('something went wrong')
                console.log(response);
            });



          });





      });

    myAppModule.directive('resize', function ($window) {
    return function ($scope, element) {
        var w = angular.element($window);
        $scope.getWindowDimensions = function () {
            return {
                'h': w.height(),
                'w': w.width()
            };
        };

        //$scope.editor = EditorObject;

        $scope.$watch($scope.getWindowDimensions, function (newValue, oldValue) {

            //debugger;
            /*
            if ($scope.editor.get()!=null) {

                var h = $scope.editor.get().display.lastWrapHeight;
                var w = $scope.editor.get().display.lastWrapWidth;

                var hh = window.innerHeight-110;
                var ww = window.innerWidth-5;

                $scope.editor.get().setSize(ww,hh);

            }
            */

            $scope.windowHeight = newValue.h;
            $scope.windowWidth = newValue.w;

        }, true);

        w.bind('resize', function () {
            $scope.$apply();
        });
    }
});

</script>



</body>
</html>
