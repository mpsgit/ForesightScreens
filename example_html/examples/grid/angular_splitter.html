<!DOCTYPE html>
<html>
<head>
    <title>AngularJS</title>
    <meta charset="utf-8">
    <link href="../content/shared/styles/examples-offline.css" rel="stylesheet">
    <link href="../../styles/kendo.common.min.css" rel="stylesheet">
    <link href="../../styles/kendo.rtl.min.css" rel="stylesheet">
    <link href="../../styles/kendo.default.min.css" rel="stylesheet">
    <link href="../../styles/kendo.default.mobile.min.css" rel="stylesheet">
    <script src="../../js/jquery.min.js"></script>
    <script src="../../js/jszip.min.js"></script>
    <script src="../../js/angular.min.js"></script>
    <script src="../../js/kendo.all.min.js"></script>
    <script src="../content/shared/js/console.js"></script>
    <script src="xml2json.js"></script>
    <script src="json2xml.js"></script>
    <script>
        
    </script>
    
    <style>
		html,
		body
		{
			height:100%;
			margin:0;
			padding:0;
			overflow:hidden;
		}
	
		#vertical,
		#horizontal
		{
			height:100%;
		}
	
		#vertical
		{
			border-width: 0;
		}
	</style>

    
</head>
<body height="100%">
    <div id="example" ng-app="KendoDemos" style="height: 100%; border: 0;">
    <div ng-controller="MyCtrl" style="height: 100%;" width="100%">
        
    <div style="height: 100%; border: 0;" kendo-splitter
			   k-panes="[ 
			   { contentUrl: 'angular_splitter_top.html',collapsible: true, size: '65%'  },
			   { contentUrl: 'angular_splitter_bottom.html',collapsible: true, size: '35%'  }
			   ]"
			   k-orientation="'vertical'"
			   >
			<div><!-- AJAX content --></div>
			<div><!-- AJAX content --></div>
		  </div>

    </div>
    
	
</div>

<style>
  .contact-info-form {
    list-style-type: none;
    margin: 30px 0;
    padding: 0;
  }

  .contact-info-form li {
    margin: 10px 0;
  }

  .contact-info-form label {
    display: inline-block;
    width: 100px;
    text-align: right;
    font-weight: bold;
  }
</style>

<script>
    angular.module("KendoDemos", [ "kendo.directives" ])
        .controller("MyCtrl", function($scope,$http){
            
        	$scope.onMainGridSelection = function(employee) {
        		debugger;
        		$scope.encodedImage=employee[0].Photo;
        	}
        		
        	//$scope.orientation = "horizontal";	
        	
        	$scope.nonEditor = function (container, options) {
				container.text(options.model[options.field]);
			};
        	
        	$scope.dataRecordsEmployes = new kendo.data.ObservableArray([]);	
        	//$scope.dataRecordsOrders = new kendo.data.ObservableArray([]);
        	
        	//$http.get('Employees').success(function (thisdata) {
            
        	$scope.jsonMyDataSourceOrders ='';
        	
        	$scope.myDatasourceOrders = new kendo.data.DataSource(
						{
							type: "odata",
							transport: {
								read: "//demos.telerik.com/kendo-ui/service/Northwind.svc/Orders"
							}
						}
					);
					
					//$scope.myDatasourceOrders.read();
					
					$scope.myDatasourceOrders.fetch(function(){
							
							var subData = $scope.myDatasourceOrders._data;
							
							var yyy = JSON.stringify(subData);
							yyy = yyy.substring(1, yyy.length-1);
							$scope.jsonMyDataSourceOrders = yyy;
							
							$scope.myDatasourceEmployees = new kendo.data.DataSource(
								{
									type: "odata",
									transport: {
										read: "//demos.telerik.com/kendo-ui/service/Northwind.svc/Employees"
									}
								}
							);
							
							//$scope.myDatasourceEmployees.read();
							
							$scope.myDatasourceEmployees.fetch(function(){
									
									var cs = '';
									var d = $scope.myDatasourceEmployees._data;
									var dd = [];
									var qcode = '';
									for (var t=0;t<800;t++) {
										if (t>0) {
											qcode += ',';
										}
										d[t%8].EmployeeID = t;
										var qqq = JSON.stringify(d[t%8]);
									
										qqq = qqq.substring(1, qqq.length-1);
										qcode += '{'+qqq+'}';
									}
							
									eval('dd.unshift('+qcode+');');
									//$scope.jsonMyDataSourceOrders
									//for (var t=0;t<dd.length;t++) {
									//	dd[t].dataRecordsOrders = new kendo.data.ObservableArray([]);
									//	cs += 'dd['+t+'].dataRecordsOrders.unshift('+yyy+');';
									//}
									//eval(cs);
									
									var xxx = JSON.stringify(dd);
									
									
									
									xxx = xxx.substring(1, xxx.length-1);
									var codeS = '$scope.dataRecordsEmployes.unshift('+xxx+');';//,'+xxx+','+xxx+','+xxx+','+xxx+','+xxx+','+xxx+','+xxx+','+xxx+','+xxx+','+xxx+','+xxx+','+xxx+','+xxx+','+xxx+');';
									eval(codeS);
									for (var h=0;h<$scope.dataRecordsEmployes.length;h++) {
										$scope.dataRecordsEmployes[h].dataRecordsOrders = new kendo.data.ObservableArray([]);
									}
									
							});
					
							
					}
			);
        	
			$scope.testDataSource = new kendo.data.DataSource({
			  data: $scope.dataRecordsEmployes,
			  pageSize: 100,
              serverPaging: false,
			  schema: {
			  	model: {
				  id: "EmployeeID",
				  fields: {
					EmployeeID: { editable: false },
					LastName : { editable: true }, 
							 	  	   FirstName : { editable: true }, 
							 		   Title : { editable: true }, 
							 		   TitleOfCourtesy : { editable: true }, 
							 		   BirthDate : { editable: true }, 
							 		   HireDate : { editable: true }, 
							 		   Address : { editable: true }, 
							 		   City : { editable: true }, 
							 		   Region : { editable: true }, 
							 		   PostalCode : { editable: true }, 
							 		   Country : { editable: true }, 
							 		   HomePhone : { editable: true }, 
							 		   Extension : { editable: true }, 
							 		   Photo : { editable: false }, 
							 		   Notes : { editable: true }, 
							 		   ReportsTo : { editable: false }, 
							 		   PhotoPath : { editable: false } 
				  }
				}
			  }
			});		
				
			
			
        	$scope.mainGridOptions = {
                dataSource: $scope.testDataSource,
                sortable: true,
                pageable: true,
                selectable: 'multiple, row',
                navigatable: true,
                dataBound: function() {
                    //this.expandRow(this.tbody.find("tr.k-master-row").first());
                },
                filterable: true,
				filter: function(e) {
				  if (e.filter == null) {
					console.log("filter has been cleared");
				  } else {
					console.log(e.filter.logic);
					console.log(e.filter.filters[0].field);
					console.log(e.filter.filters[0].operator);
					console.log(e.filter.filters[0].value);
				  }
				},
                columns: [
                	{
                	field: "EmployeeID",
                	title: "Employee ID",
                	width: "140px",
                	editor: $scope.nonEditor
                	},	
                	{
                    field: "FirstName",
                    title: "First Name",
                    width: "120px"
                    },{
                    field: "LastName",
                    title: "Last Name",
                    width: "120px"
                    },{
                    field: "Country",
                    width: "120px"
                    },{
                    field: "City",
                    width: "120px"
                    },{
                    field: "Title",
                    width: "200px"
                	},{
                	field: "Notes",
                	width: "150px"
                	}
                ],
                editable: true
                /*
                filterable: {
                            mode: "row"
                }*/
            };

            $scope.detailGridOptions = function(dataItem) {
            	
            	if (!dataItem.dataLoaded) {
            		
            		dataItem.dataLoaded=true;
            		
            		dataItem.testDataSource = new kendo.data.DataSource({
					  data: dataItem.dataRecordsOrders,
					  pageSize: 10,
					  serverPaging: false
					});
            		
            		var lazyCode = 'dataItem.dataRecordsOrders.unshift('+$scope.jsonMyDataSourceOrders+');';
            		eval(lazyCode);
            	}
            	
                return {
                    dataSource: dataItem.testDataSource,
                    /*
                    {
                        type: "odata",
                        transport: {
                            read: "//demos.telerik.com/kendo-ui/service/Northwind.svc/Orders"
                        },
                        serverPaging: false,
                        serverSorting: false,
                        serverFiltering: false,
                        pageSize: 50,
                        filter: { field: "EmployeeID", operator: "eq", value: dataItem.EmployeeID }
                    },*/
                    scrollable: false,
                    sortable: true,
                    navigatable: true,
                    pageable: true,
                    selectable: 'multiple, row',
                    filterable: true,
                    columns: [
                    { field: "OrderID", title:"ID", width: "150px",editor: $scope.nonEditor },
                    { field: "ShipCountry", title:"Ship Country", width: "200px" },
                    { field: "ShipAddress", title:"Ship Address", width: "250px" },
                    { field: "ShipName", title: "Ship Name", width: "200px" }
                    ],
                    
                    editable: true/*,
                    filterable: {
                            mode: "row"
                    }*/
                };
            };
        })
</script>


    
</body>
</html>
